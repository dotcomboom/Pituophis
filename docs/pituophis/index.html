<!doctype html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />

    <title>pituophis API documentation</title>
    <meta name="description" content="" />

  <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,300' rel='stylesheet' type='text/css'>
  
  <style type="text/css">
  
* {
  box-sizing: border-box;
}
/*! normalize.css v1.1.1 | MIT License | git.io/normalize */

/* ==========================================================================
   HTML5 display definitions
   ========================================================================== */

/**
 * Correct `block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

article,
aside,
details,
figcaption,
figure,
footer,
header,
hgroup,
main,
nav,
section,
summary {
    display: block;
}

/**
 * Correct `inline-block` display not defined in IE 6/7/8/9 and Firefox 3.
 */

audio,
canvas,
video {
    display: inline-block;
    *display: inline;
    *zoom: 1;
}

/**
 * Prevent modern browsers from displaying `audio` without controls.
 * Remove excess height in iOS 5 devices.
 */

audio:not([controls]) {
    display: none;
    height: 0;
}

/**
 * Address styling not present in IE 7/8/9, Firefox 3, and Safari 4.
 * Known issue: no IE 6 support.
 */

[hidden] {
    display: none;
}

/* ==========================================================================
   Base
   ========================================================================== */

/**
 * 1. Prevent system color scheme's background color being used in Firefox, IE,
 *    and Opera.
 * 2. Prevent system color scheme's text color being used in Firefox, IE, and
 *    Opera.
 * 3. Correct text resizing oddly in IE 6/7 when body `font-size` is set using
 *    `em` units.
 * 4. Prevent iOS text size adjust after orientation change, without disabling
 *    user zoom.
 */

html {
    background: #fff; /* 1 */
    color: #000; /* 2 */
    font-size: 100%; /* 3 */
    -webkit-text-size-adjust: 100%; /* 4 */
    -ms-text-size-adjust: 100%; /* 4 */
}

/**
 * Address `font-family` inconsistency between `textarea` and other form
 * elements.
 */

html,
button,
input,
select,
textarea {
    font-family: sans-serif;
}

/**
 * Address margins handled incorrectly in IE 6/7.
 */

body {
    margin: 0;
}

/* ==========================================================================
   Links
   ========================================================================== */

/**
 * Address `outline` inconsistency between Chrome and other browsers.
 */

a:focus {
    outline: thin dotted;
}

/**
 * Improve readability when focused and also mouse hovered in all browsers.
 */

a:active,
a:hover {
    outline: 0;
}

/* ==========================================================================
   Typography
   ========================================================================== */

/**
 * Address font sizes and margins set differently in IE 6/7.
 * Address font sizes within `section` and `article` in Firefox 4+, Safari 5,
 * and Chrome.
 */

h1 {
    font-size: 2em;
    margin: 0.67em 0;
}

h2 {
    font-size: 1.5em;
    margin: 0.83em 0;
}

h3 {
    font-size: 1.17em;
    margin: 1em 0;
}

h4 {
    font-size: 1em;
    margin: 1.33em 0;
}

h5 {
    font-size: 0.83em;
    margin: 1.67em 0;
}

h6 {
    font-size: 0.67em;
    margin: 2.33em 0;
}

/**
 * Address styling not present in IE 7/8/9, Safari 5, and Chrome.
 */

abbr[title] {
    border-bottom: 1px dotted;
}

/**
 * Address style set to `bolder` in Firefox 3+, Safari 4/5, and Chrome.
 */

b,
strong {
    font-weight: bold;
}

blockquote {
    margin: 1em 40px;
}

/**
 * Address styling not present in Safari 5 and Chrome.
 */

dfn {
    font-style: italic;
}

/**
 * Address differences between Firefox and other browsers.
 * Known issue: no IE 6/7 normalization.
 */

hr {
    -moz-box-sizing: content-box;
    box-sizing: content-box;
    height: 0;
}

/**
 * Address styling not present in IE 6/7/8/9.
 */

mark {
    background: #ff0;
    color: #000;
}

/**
 * Address margins set differently in IE 6/7.
 */

p,
pre {
    margin: 1em 0;
}

/**
 * Correct font family set oddly in IE 6, Safari 4/5, and Chrome.
 */

code,
kbd,
pre,
samp {
    font-family: monospace, serif;
    _font-family: 'courier new', monospace;
    font-size: 1em;
}

/**
 * Improve readability of pre-formatted text in all browsers.
 */

pre {
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
}

/**
 * Address CSS quotes not supported in IE 6/7.
 */

q {
    quotes: none;
}

/**
 * Address `quotes` property not supported in Safari 4.
 */

q:before,
q:after {
    content: '';
    content: none;
}

/**
 * Address inconsistent and variable font size in all browsers.
 */

small {
    font-size: 80%;
}

/**
 * Prevent `sub` and `sup` affecting `line-height` in all browsers.
 */

sub,
sup {
    font-size: 75%;
    line-height: 0;
    position: relative;
    vertical-align: baseline;
}

sup {
    top: -0.5em;
}

sub {
    bottom: -0.25em;
}

/* ==========================================================================
   Lists
   ========================================================================== */

/**
 * Address margins set differently in IE 6/7.
 */

dl,
menu,
ol,
ul {
    margin: 1em 0;
}

dd {
    margin: 0 0 0 40px;
}

/**
 * Address paddings set differently in IE 6/7.
 */

menu,
ol,
ul {
    padding: 0 0 0 40px;
}

/**
 * Correct list images handled incorrectly in IE 7.
 */

nav ul,
nav ol {
    list-style: none;
    list-style-image: none;
}

/* ==========================================================================
   Embedded content
   ========================================================================== */

/**
 * 1. Remove border when inside `a` element in IE 6/7/8/9 and Firefox 3.
 * 2. Improve image quality when scaled in IE 7.
 */

img {
    border: 0; /* 1 */
    -ms-interpolation-mode: bicubic; /* 2 */
}

/**
 * Correct overflow displayed oddly in IE 9.
 */

svg:not(:root) {
    overflow: hidden;
}

/* ==========================================================================
   Figures
   ========================================================================== */

/**
 * Address margin not present in IE 6/7/8/9, Safari 5, and Opera 11.
 */

figure {
    margin: 0;
}

/* ==========================================================================
   Forms
   ========================================================================== */

/**
 * Correct margin displayed oddly in IE 6/7.
 */

form {
    margin: 0;
}

/**
 * Define consistent border, margin, and padding.
 */

fieldset {
    border: 1px solid #c0c0c0;
    margin: 0 2px;
    padding: 0.35em 0.625em 0.75em;
}

/**
 * 1. Correct color not being inherited in IE 6/7/8/9.
 * 2. Correct text not wrapping in Firefox 3.
 * 3. Correct alignment displayed oddly in IE 6/7.
 */

legend {
    border: 0; /* 1 */
    padding: 0;
    white-space: normal; /* 2 */
    *margin-left: -7px; /* 3 */
}

/**
 * 1. Correct font size not being inherited in all browsers.
 * 2. Address margins set differently in IE 6/7, Firefox 3+, Safari 5,
 *    and Chrome.
 * 3. Improve appearance and consistency in all browsers.
 */

button,
input,
select,
textarea {
    font-size: 100%; /* 1 */
    margin: 0; /* 2 */
    vertical-align: baseline; /* 3 */
    *vertical-align: middle; /* 3 */
}

/**
 * Address Firefox 3+ setting `line-height` on `input` using `!important` in
 * the UA stylesheet.
 */

button,
input {
    line-height: normal;
}

/**
 * Address inconsistent `text-transform` inheritance for `button` and `select`.
 * All other form control elements do not inherit `text-transform` values.
 * Correct `button` style inheritance in Chrome, Safari 5+, and IE 6+.
 * Correct `select` style inheritance in Firefox 4+ and Opera.
 */

button,
select {
    text-transform: none;
}

/**
 * 1. Avoid the WebKit bug in Android 4.0.* where (2) destroys native `audio`
 *    and `video` controls.
 * 2. Correct inability to style clickable `input` types in iOS.
 * 3. Improve usability and consistency of cursor style between image-type
 *    `input` and others.
 * 4. Remove inner spacing in IE 7 without affecting normal text inputs.
 *    Known issue: inner spacing remains in IE 6.
 */

button,
html input[type="button"], /* 1 */
input[type="reset"],
input[type="submit"] {
    -webkit-appearance: button; /* 2 */
    cursor: pointer; /* 3 */
    *overflow: visible;  /* 4 */
}

/**
 * Re-set default cursor for disabled elements.
 */

button[disabled],
html input[disabled] {
    cursor: default;
}

/**
 * 1. Address box sizing set to content-box in IE 8/9.
 * 2. Remove excess padding in IE 8/9.
 * 3. Remove excess padding in IE 7.
 *    Known issue: excess padding remains in IE 6.
 */

input[type="checkbox"],
input[type="radio"] {
    box-sizing: border-box; /* 1 */
    padding: 0; /* 2 */
    *height: 13px; /* 3 */
    *width: 13px; /* 3 */
}

/**
 * 1. Address `appearance` set to `searchfield` in Safari 5 and Chrome.
 * 2. Address `box-sizing` set to `border-box` in Safari 5 and Chrome
 *    (include `-moz` to future-proof).
 */

input[type="search"] {
    -webkit-appearance: textfield; /* 1 */
    -moz-box-sizing: content-box;
    -webkit-box-sizing: content-box; /* 2 */
    box-sizing: content-box;
}

/**
 * Remove inner padding and search cancel button in Safari 5 and Chrome
 * on OS X.
 */

input[type="search"]::-webkit-search-cancel-button,
input[type="search"]::-webkit-search-decoration {
    -webkit-appearance: none;
}

/**
 * Remove inner padding and border in Firefox 3+.
 */

button::-moz-focus-inner,
input::-moz-focus-inner {
    border: 0;
    padding: 0;
}

/**
 * 1. Remove default vertical scrollbar in IE 6/7/8/9.
 * 2. Improve readability and alignment in all browsers.
 */

textarea {
    overflow: auto; /* 1 */
    vertical-align: top; /* 2 */
}

/* ==========================================================================
   Tables
   ========================================================================== */

/**
 * Remove most spacing between table cells.
 */

table {
    border-collapse: collapse;
    border-spacing: 0;
}

  </style>

  <style type="text/css">
  
  html, body {
    margin: 0;
    padding: 0;
    min-height: 100%;
  }
  body {
    background: #fff;
    font-family: "Source Sans Pro", "Helvetica Neueue", Helvetica, sans;
    font-weight: 300;
    font-size: 16px;
    line-height: 1.6em;
  }
  #content {
    width: 70%;
    max-width: 850px;
    float: left;
    padding: 30px 60px;
    border-left: 1px solid #ddd;
  }
  #sidebar {
    width: 25%;
    float: left;
    padding: 30px;
    overflow: hidden;
  }
  #nav {
    font-size: 130%;
    margin: 0 0 15px 0;
  }

  #top {
    display: block;
    position: fixed;
    bottom: 5px;
    left: 5px;
    font-size: .85em;
    text-transform: uppercase;
  }

  #footer {
    font-size: .75em;
    padding: 5px 30px;
    border-top: 1px solid #ddd;
    text-align: right;
  }
    #footer p {
      margin: 0 0 0 30px;
      display: inline-block;
    }

  h1, h2, h3, h4, h5 {
    font-weight: 300;
  }
  h1 {
    font-size: 2.5em;
    line-height: 1.1em;
    margin: 0 0 .50em 0;
  }

  h2 {
    font-size: 1.75em;
    margin: 1em 0 .50em 0;
  }

  h3 {
    margin: 25px 0 10px 0;
  }

  h4 {
    margin: 0;
    font-size: 105%;
  }

  a {
    color: #058;
    text-decoration: none;
    transition: color .3s ease-in-out;
  }

  a:hover {
    color: #e08524;
    transition: color .3s ease-in-out;
  }

  pre, code, .mono, .name {
    font-family: "Ubuntu Mono", "Cousine", "DejaVu Sans Mono", monospace;
  }

  .title .name {
    font-weight: bold;
  }
  .section-title {
    margin-top: 2em;
  }
  .ident {
    color: #900;
  }

  code {
    background: #f9f9f9;
  } 

  pre {
    background: #fefefe;
    border: 1px solid #ddd;
    box-shadow: 2px 2px 0 #f3f3f3;
    margin: 0 30px;
    padding: 15px 30px;
  }

  .codehilite {
    margin: 0 30px 10px 30px;
  }

    .codehilite pre {
      margin: 0;
    }
    .codehilite .err { background: #ff3300; color: #fff !important; } 

  table#module-list {
    font-size: 110%;
  }

    table#module-list tr td:first-child {
      padding-right: 10px;
      white-space: nowrap;
    }

    table#module-list td {
      vertical-align: top;
      padding-bottom: 8px;
    }

      table#module-list td p {
        margin: 0 0 7px 0;
      }

  .def {
    display: table;
  }

    .def p {
      display: table-cell;
      vertical-align: top;
      text-align: left;
    }

    .def p:first-child {
      white-space: nowrap;
    }

    .def p:last-child {
      width: 100%;
    }


  #index {
    list-style-type: none;
    margin: 0;
    padding: 0;
  }
    ul#index .class_name {
      /* font-size: 110%; */
      font-weight: bold;
    }
    #index ul {
      margin: 0;
    }

  .item {
    margin: 0 0 15px 0;
  }

    .item .class {
      margin: 0 0 25px 30px;
    }

      .item .class ul.class_list {
        margin: 0 0 20px 0;
      }

    .item .name {
      background: #fafafa;
      margin: 0;
      font-weight: bold;
      padding: 5px 10px;
      border-radius: 3px;
      display: inline-block;
      min-width: 40%;
    }
      .item .name:hover {
        background: #f6f6f6;
      }

    .item .empty_desc {
      margin: 0 0 5px 0;
      padding: 0;
    }

    .item .inheritance {
      margin: 3px 0 0 30px;
    }

    .item .inherited {
      color: #666;
    }

    .item .desc {
      padding: 0 8px;
      margin: 0;
    }

      .item .desc p {
        margin: 0 0 10px 0;
      }

    .source_cont {
      margin: 0;
      padding: 0;
    }

    .source_link a {
      background: #ffc300;
      font-weight: 400;
      font-size: .75em;
      text-transform: uppercase;
      color: #fff;
      text-shadow: 1px 1px 0 #f4b700;
      
      padding: 3px 8px;
      border-radius: 2px;
      transition: background .3s ease-in-out;
    }
      .source_link a:hover {
        background: #FF7200;
        text-shadow: none;
        transition: background .3s ease-in-out;
      }

    .source {
      display: none;
      max-height: 600px;
      overflow-y: scroll;
      margin-bottom: 15px;
    }

      .source .codehilite {
        margin: 0;
      }

  .desc h1, .desc h2, .desc h3 {
    font-size: 100% !important;
  }
  .clear {
    clear: both;
  }

  @media all and (max-width: 950px) {
    #sidebar {
      width: 35%;
    }
    #content {
      width: 65%;
    }
  }
  @media all and (max-width: 650px) {
    #top {
      display: none;
    }
    #sidebar {
      float: none;
      width: auto;
    }
    #content {
      float: none;
      width: auto;
      padding: 30px;
    }

    #index ul {
      padding: 0;
      margin-bottom: 15px;
    }
    #index ul li {
      display: inline-block;
      margin-right: 30px;
    }
    #footer {
      text-align: left;
    }
    #footer p {
      display: block;
      margin: inherit;
    }
  }

  /*****************************/

  </style>

  <style type="text/css">
  .codehilite .hll { background-color: #ffffcc }
.codehilite  { background: #f8f8f8; }
.codehilite .c { color: #408080; font-style: italic } /* Comment */
.codehilite .err { border: 1px solid #FF0000 } /* Error */
.codehilite .k { color: #008000; font-weight: bold } /* Keyword */
.codehilite .o { color: #666666 } /* Operator */
.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */
.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */
.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */
.codehilite .gd { color: #A00000 } /* Generic.Deleted */
.codehilite .ge { font-style: italic } /* Generic.Emph */
.codehilite .gr { color: #FF0000 } /* Generic.Error */
.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.codehilite .gi { color: #00A000 } /* Generic.Inserted */
.codehilite .go { color: #888888 } /* Generic.Output */
.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.codehilite .gs { font-weight: bold } /* Generic.Strong */
.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.codehilite .gt { color: #0044DD } /* Generic.Traceback */
.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.codehilite .kp { color: #008000 } /* Keyword.Pseudo */
.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.codehilite .kt { color: #B00040 } /* Keyword.Type */
.codehilite .m { color: #666666 } /* Literal.Number */
.codehilite .s { color: #BA2121 } /* Literal.String */
.codehilite .na { color: #7D9029 } /* Name.Attribute */
.codehilite .nb { color: #008000 } /* Name.Builtin */
.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.codehilite .no { color: #880000 } /* Name.Constant */
.codehilite .nd { color: #AA22FF } /* Name.Decorator */
.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */
.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.codehilite .nf { color: #0000FF } /* Name.Function */
.codehilite .nl { color: #A0A000 } /* Name.Label */
.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */
.codehilite .nv { color: #19177C } /* Name.Variable */
.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.codehilite .w { color: #bbbbbb } /* Text.Whitespace */
.codehilite .mb { color: #666666 } /* Literal.Number.Bin */
.codehilite .mf { color: #666666 } /* Literal.Number.Float */
.codehilite .mh { color: #666666 } /* Literal.Number.Hex */
.codehilite .mi { color: #666666 } /* Literal.Number.Integer */
.codehilite .mo { color: #666666 } /* Literal.Number.Oct */
.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */
.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */
.codehilite .sc { color: #BA2121 } /* Literal.String.Char */
.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */
.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */
.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */
.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.codehilite .sx { color: #008000 } /* Literal.String.Other */
.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */
.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */
.codehilite .ss { color: #19177C } /* Literal.String.Symbol */
.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */
.codehilite .fm { color: #0000FF } /* Name.Function.Magic */
.codehilite .vc { color: #19177C } /* Name.Variable.Class */
.codehilite .vg { color: #19177C } /* Name.Variable.Global */
.codehilite .vi { color: #19177C } /* Name.Variable.Instance */
.codehilite .vm { color: #19177C } /* Name.Variable.Magic */
.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */
  </style>

  <style type="text/css">
  
/* ==========================================================================
   EXAMPLE Media Queries for Responsive Design.
   These examples override the primary ('mobile first') styles.
   Modify as content requires.
   ========================================================================== */

@media only screen and (min-width: 35em) {
    /* Style adjustments for viewports that meet the condition */
}

@media print,
       (-o-min-device-pixel-ratio: 5/4),
       (-webkit-min-device-pixel-ratio: 1.25),
       (min-resolution: 120dpi) {
    /* Style adjustments for high resolution devices */
}

/* ==========================================================================
   Print styles.
   Inlined to avoid required HTTP connection: h5bp.com/r
   ========================================================================== */

@media print {
    * {
        background: transparent !important;
        color: #000 !important; /* Black prints faster: h5bp.com/s */
        box-shadow: none !important;
        text-shadow: none !important;
    }

    a,
    a:visited {
        text-decoration: underline;
    }

    a[href]:after {
        content: " (" attr(href) ")";
    }

    abbr[title]:after {
        content: " (" attr(title) ")";
    }

    /*
     * Don't show links for images, or javascript/internal links
     */

    .ir a:after,
    a[href^="javascript:"]:after,
    a[href^="#"]:after {
        content: "";
    }

    pre,
    blockquote {
        border: 1px solid #999;
        page-break-inside: avoid;
    }

    thead {
        display: table-header-group; /* h5bp.com/t */
    }

    tr,
    img {
        page-break-inside: avoid;
    }

    img {
        max-width: 100% !important;
    }

    @page {
        margin: 0.5cm;
    }

    p,
    h2,
    h3 {
        orphans: 3;
        widows: 3;
    }

    h2,
    h3 {
        page-break-after: avoid;
    }
}

  </style>

  <script type="text/javascript">
  function toggle(id, $link) {
    $node = document.getElementById(id);
    if (!$node)
    return;
    if (!$node.style.display || $node.style.display == 'none') {
    $node.style.display = 'block';
    $link.innerHTML = 'Hide source &nequiv;';
    } else {
    $node.style.display = 'none';
    $link.innerHTML = 'Show source &equiv;';
    }
  }
  </script>
</head>
<body>
<a href="#" id="top">Top</a>

<div id="container">
    
  
  <div id="sidebar">
    <h1>Index</h1>
    <ul id="index">

    <li class="set"><h3><a href="#header-functions">Functions</a></h3>
      
  <ul>
      <li class="mono"><a href="#pituophis.encode">encode</a></li>
    <li class="mono"><a href="#pituophis.get">get</a></li>
    <li class="mono"><a href="#pituophis.handle">handle</a></li>
    <li class="mono"><a href="#pituophis.parse_gophermap">parse_gophermap</a></li>
      <li class="mono"><a href="#pituophis.parse_menu">parse_menu</a></li>
    <li class="mono"><a href="#pituophis.parse_url">parse_url</a></li>
    <li class="mono"><a href="#pituophis.serve">serve</a></li>
  </ul>

    </li>

    <li class="set"><h3><a href="#header-classes">Classes</a></h3>
      <ul>
        <li class="mono">
        <span class="class_name"><a href="#pituophis.Request">Request</a></span>
        
          
  <ul>
    <li class="mono"><a href="#pituophis.Request.__init__">__init__</a></li>
    <li class="mono"><a href="#pituophis.Request.get">get</a></li>
    <li class="mono"><a href="#pituophis.Request.url">url</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#pituophis.Response">Response</a></span>
        
          
  <ul>
    <li class="mono"><a href="#pituophis.Response.__init__">__init__</a></li>
    <li class="mono"><a href="#pituophis.Response.menu">menu</a></li>
    <li class="mono"><a href="#pituophis.Response.text">text</a></li>
  </ul>

        </li>
        <li class="mono">
        <span class="class_name"><a href="#pituophis.Selector">Selector</a></span>
        
          
  <ul>
    <li class="mono"><a href="#pituophis.Selector.__init__">__init__</a></li>
      <li class="mono"><a href="#pituophis.Selector.source">source</a></li>
  </ul>

        </li>
      </ul>
    </li>

    </ul>
  </div>

    <article id="content">
      
  

  


  <header id="section-intro">
  <h1 class="title"><span class="name">pituophis</span> module</h1>
  
  
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pituophis', this);">Show source &equiv;</a></p>
  <div id="source-pituophis" class="source">
    <div class="codehilite"><pre><span></span><span class="c1"># BSD 2-Clause License</span>
<span class="c1">#</span>
<span class="c1"># Copyright (c) 2019, dotcomboom &lt;dotcomboom@protonmail.com&gt; and contributors</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions of source code must retain the above copyright notice, this</span>
<span class="c1">#   List of conditions and the following disclaimer.</span>
<span class="c1">#</span>
<span class="c1"># * Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this List of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE</span>
<span class="c1"># DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE</span>
<span class="c1"># FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL</span>
<span class="c1"># DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR</span>
<span class="c1"># SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER</span>
<span class="c1"># CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,</span>
<span class="c1"># OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE</span>
<span class="c1"># OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="c1">#</span>
<span class="c1"># Portions copyright solderpunk &amp; VF-1 contributors, licensed under the BSD 2-Clause License above.</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">ssl</span>


<span class="c1"># Quick note:</span>
<span class="c1"># selectors and item types are actually *not* sent to the server, just the path of the resource</span>


<span class="k">class</span> <span class="nc">Response</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Client.* Returned by Request.get() and get(). Represents a received binary object from a Gopher server.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads a BufferedReader to the object&#39;s binary property and initializes a new Response object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binary</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The data received from the server as a Bytes binary object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the binary decoded as a UTF-8 String.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Decodes the binary as text and parses it as a Gopher menu. Returns a List of Gopher menu items parsed as the Selector type.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">parse_menu</span><span class="p">(</span><span
                class="bp">self</span><span class="o">.</span><span class="n">binary</span><span class="o">.</span><span
                class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span
                class="p">))</span>


<span class="k">class</span> <span class="nc">Request</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Client/Server.* Represents a request to be sent to a Gopher server, or received from a client.</span>

<span class="sd">    The type property is not used when sending or receiving requests; it&#39;s purely for client-side usage.</span>
<span class="sd">    The tls_verify property determines if the client will trust a self-signed certificate when using TLS.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span
                class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span
                class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">70</span><span
                class="p">,</span> <span class="n">path</span><span class="o">=</span><span
                class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">query</span><span
                class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span
                class="n">itype</span><span class="o">=</span><span class="s1">&#39;9&#39;</span><span
                class="p">,</span> <span class="n">tls</span><span class="o">=</span><span class="bp">False</span><span
                class="p">,</span> <span class="n">tls_verify</span><span class="o">=</span><span class="bp">True</span><span
                class="p">,</span> <span class="n">client</span><span class="o">=</span><span
                class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes a new Request object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span
                class="nb">str</span><span class="p">(</span><span class="n">host</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Client/Server.* The hostname of the server.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span
                class="nb">int</span><span class="p">(</span><span class="n">port</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Client/Server.* The port of the server. For regular Gopher servers, this is most commonly 70, </span>
<span class="sd">        and for S/Gopher servers it is typically 105.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span
                class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Client/Server.* Path on the target server to request, or being requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tls</span> <span class="o">=</span> <span
                class="n">tls</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Client.* Whether the target server is an S/Gopher server with TLS enabled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">=</span> <span
                class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Client/Server.* Search query for the server to process. Omitted when blank.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span
                class="nb">str</span><span class="p">(</span><span class="n">itype</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Client.* Item type of the request. Purely for client-side usage.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tls</span> <span class="o">=</span> <span
                class="n">tls</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Client.* Whether the request is to be sent to an S/Gopher server over TLS.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tls_verify</span> <span
                class="o">=</span> <span class="n">tls_verify</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Client.* Whether to verify the certificate sent from the server, rejecting self-signed and invalid certificates.</span>
<span class="sd">        ***Currently stuck on True in some functions.***</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span
                class="nb">str</span><span class="p">(</span><span class="n">client</span><span
                class="p">)</span>  <span class="c1"># only used in server</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Server.* The IP address of the connected client.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sends the Request and returns a Response object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tls</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span
                class="o">.</span><span class="n">_create_unverified_context</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span
                class="n">tls_verify</span><span class="p">:</span>  <span class="c1"># TODO: for some reason this is always true when using the get() shorthand</span>
                <span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span
                class="o">.</span><span class="n">create_default_context</span><span class="p">()</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">server_hostname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>
        <span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span
                class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span
                class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span
                class="n">port</span><span class="p">)))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span>
        <span class="n">s</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">makefile</span><span class="p">(</span><span class="s1">&#39;rb&#39;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a URL equivalent to the Request&#39;s properties.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">protocol</span> <span class="o">=</span> <span class="s1">&#39;gopher&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tls</span><span class="p">:</span>
            <span class="n">protocol</span> <span class="o">=</span> <span class="s1">&#39;gophers&#39;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">path</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
            <span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span>
        <span class="k">return</span> <span class="n">protocol</span> <span class="o">+</span> <span class="s1">&#39;://&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">Selector</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Server/Client.* Represents a selector in a parsed Gopher menu.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span
                class="p">,</span> <span class="n">itype</span><span class="o">=</span><span
                class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">text</span><span
                class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">path</span><span
                class="o">=</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span
                class="n">host</span><span class="o">=</span><span class="s1">&#39;error.host&#39;</span><span
                class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">0</span><span
                class="p">,</span> <span class="n">tls</span><span class="o">=</span><span class="bp">False</span><span
                class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes a new Selector object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span
                class="n">itype</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The type of item.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span
                class="n">text</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The name, or text that is displayed when the item is in a menu.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span
                class="n">path</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Where the item links to on the target server.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span
                class="n">host</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The hostname of the target server.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span
                class="n">port</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The port of the target server. For regular Gopher servers, this is most commonly 70, </span>
<span class="sd">        and for S/Gopher servers it is typically 105.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tls</span> <span class="o">=</span> <span
                class="n">tls</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        True if the selector leads to an S/Gopher server with TLS enabled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">source</span><span class="p">(</span><span class="bp">self</span><span
                class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a representation of what the selector looks like in a Gopher menu.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span
                class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">port</span> <span class="o">&lt;</span> <span
                class="mi">65535</span><span class="p">:</span>
            <span class="c1"># Add digits to display that this is a TLS selector</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span
                class="nb">str</span><span class="p">(</span><span class="n">port</span><span class="p">))</span> <span
                class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">port</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span> <span
                class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">port</span><span
                class="p">)</span>
            <span class="n">port</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span> <span
                class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">port</span><span
                class="p">)</span>
            <span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span
                class="p">(</span><span class="n">port</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span
                class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span
                class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span
                class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="o">+</span> <span
                class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span
                class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span
                class="n">path</span><span class="p">)</span> <span class="o">+</span> <span
                class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span
                class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span
                class="n">host</span><span class="p">)</span> <span class="o">+</span> <span
                class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span
                class="nb">str</span><span class="p">(</span>
            <span class="n">port</span><span class="p">)</span> <span class="o">+</span> <span
                class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span>


<span class="k">def</span> <span class="nf">parse_menu</span><span class="p">(</span><span class="n">source</span><span
                class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Client.* Parses a String as a Gopher menu. Returns a List of Selectors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parsed_menu</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">menu</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span
                class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span
                class="se">\r\n</span><span class="s1">&#39;</span><span class="p">,</span> <span
                class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span
                class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span
                class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span
                class="p">,</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span
                class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span
                class="p">(</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span
                class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">menu</span><span
                class="p">:</span>
        <span class="n">selector</span> <span class="o">=</span> <span class="n">Selector</span><span
                class="p">()</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span
                class="n">startswith</span><span class="p">(</span><span class="s1">&#39;i&#39;</span><span
                class="p">):</span>
            <span class="n">selector</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span
                class="s1">&#39;i&#39;</span>
            <span class="n">selector</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span
                class="n">line</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span><span
                class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span
                class="se">\t</span><span class="s1">&#39;</span><span class="p">)[</span><span class="mi">0</span><span
                class="p">]</span>
            <span class="n">selector</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span
                class="s1">&#39;/&#39;</span>
            <span class="n">selector</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span
                class="s1">&#39;error.host&#39;</span>
            <span class="n">selector</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span
                class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">matches</span> <span class="o">=</span> <span class="n">re</span><span
                class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span
                class="s1">&#39;^(.)(.*)\t(.*)\t(.*)\t(.*)&#39;</span><span class="p">,</span> <span
                class="n">line</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">matches</span><span class="p">:</span>
                <span class="n">selector</span><span class="o">.</span><span class="n">type</span> <span
                class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="mi">1</span><span
                class="p">]</span>
                <span class="n">selector</span><span class="o">.</span><span class="n">text</span> <span
                class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="mi">2</span><span
                class="p">]</span>
                <span class="n">selector</span><span class="o">.</span><span class="n">path</span> <span
                class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="mi">3</span><span
                class="p">]</span>
                <span class="n">selector</span><span class="o">.</span><span class="n">host</span> <span
                class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="mi">4</span><span
                class="p">]</span>
                <span class="n">selector</span><span class="o">.</span><span class="n">port</span> <span
                class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="mi">5</span><span
                class="p">]</span>
                <span class="c1"># detect TLS</span>
                <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span
                class="n">selector</span><span class="o">.</span><span class="n">port</span><span
                class="p">)</span> <span class="o">&gt;</span> <span class="mi">65535</span><span class="p">:</span>
                    <span class="n">selector</span><span class="o">.</span><span class="n">tls</span> <span
                class="o">=</span> <span class="bp">True</span>
                    <span class="c1"># typically the port is sent as 100105</span>
                    <span class="c1"># remove first number to get at 5 digits</span>
                    <span class="n">selector</span><span class="o">.</span><span class="n">port</span> <span
                class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span
                class="p">(</span><span class="n">selector</span><span class="o">.</span><span
                class="n">port</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="n">parsed_menu</span><span class="o">.</span><span class="n">append</span><span
                class="p">(</span><span class="n">selector</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parsed_menu</span>


<span class="k">def</span> <span class="nf">parse_url</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Client.* Parses a Gopher URL and returns an equivalent Request.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">tls</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="c1"># condense multiple slashes to one</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/+&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
    <span class="c1"># add protocol if not there</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;:/&#39;</span> <span
                class="ow">in</span> <span class="n">url</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;gopher:/&#39;</span> <span
                class="o">+</span> <span class="n">url</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
    <span class="c1"># split into protocol, host &amp; port, and then the following items for the selector/path</span>
    <span class="c1"># gopher:</span>
    <span class="c1"># gopher.floodgap.com:70</span>
    <span class="c1"># gopher/</span>
    <span class="c1"># detect tls and remove protocol</span>
    <span class="k">if</span> <span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;gophers:&#39;</span><span class="p">:</span>
            <span class="n">req</span><span class="o">.</span><span class="n">tls</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">url</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># set and remove host/port</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">req</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">req</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span
                class="nb">int</span><span class="p">(</span><span class="n">url</span><span class="p">[</span><span
                class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span
                class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span
                class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">req</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">url</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># remove selector if it is there</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">url</span><span
                class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">url</span><span
                class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span
                class="mi">1</span><span class="p">:</span>
            <span class="n">req</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span
                class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">url</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span
                class="mi">0</span><span class="p">)</span>
    <span class="c1"># set url to path?query</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">req</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">url</span>
    <span class="c1"># split query if it is there</span>
    <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)</span>
        <span class="n">req</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">url</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">req</span><span class="o">.</span><span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">req</span>


<span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="n">host</span><span
                class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">70</span><span
                class="p">,</span> <span class="n">path</span><span class="o">=</span><span
                class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">query</span><span
                class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span
                class="n">tls</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span
                class="n">tls_verify</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Client.* Quickly creates and sends a Request. Returns a Response object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span
                class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span
                class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span
                class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span
                class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span> <span
                class="n">tls</span><span class="o">=</span><span class="n">tls</span><span class="p">,</span> <span
                class="n">tls_verify</span><span class="o">=</span><span class="n">tls_verify</span><span
                class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;/&#39;</span> <span class="ow">in</span> <span class="n">host</span> <span
                class="ow">or</span> <span class="s1">&#39;:&#39;</span> <span class="ow">in</span> <span
                class="n">host</span><span class="p">:</span>
        <span class="n">req</span> <span class="o">=</span> <span class="n">parse_url</span><span class="p">(</span><span class="n">host</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">req</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>


<span class="c1"># Server stuff</span>
<span class="k">def</span> <span class="nf">parse_gophermap</span><span class="p">(</span><span
                class="n">source</span><span class="p">,</span> <span class="n">defHost</span><span
                class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span class="n">defPort</span><span
                class="o">=</span><span class="s1">&#39;70&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Server.* Converts a Gophermap (as a String or List) into a Gopher menu. Returns a List of lines to send.</span>
<span class="sd">    This is *not* as feature-complete as the actual Bucktooth implementation; one example being how paths</span>
<span class="sd">    are not resolved. It does, however, fill in missing selector, host, and port fields,</span>
<span class="sd">    given that the correct host and port values are passed to it.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># NOTICE:</span>
    <span class="c1"># Relative links are *not* fixed with this function!</span>
    <span class="c1"># The path isn&#39;t ever touched, so this is more for convenience of making menus</span>
    <span class="c1"># (filling in the blank fields, information selectors...)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">source</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">newMenu</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">selector</span> <span class="ow">in</span> <span class="n">source</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">selector</span><span class="p">:</span>
            <span class="c1"># this is not information</span>
            <span class="n">selector</span> <span class="o">=</span> <span class="n">selector</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="c1"># 1Text    pictures/    host.host    port</span>
            <span class="c1">#  ^           ^           ^           ^</span>
            <span class="n">itype</span> <span class="o">=</span> <span class="n">selector</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">selector</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">selector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>
            <span class="n">host</span> <span class="o">=</span> <span class="n">defHost</span>
            <span class="n">port</span> <span class="o">=</span> <span class="n">defPort</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selector</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">selector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selector</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">host</span> <span class="o">=</span> <span class="n">selector</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selector</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">port</span> <span class="o">=</span> <span class="n">selector</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

            <span class="n">selector</span> <span class="o">=</span> <span class="p">[</span><span class="n">itype</span> <span class="o">+</span> <span class="n">text</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">]</span>
            <span class="n">newMenu</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">selector</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">selector</span> <span class="o">=</span> <span class="s1">&#39;i&#39;</span> <span class="o">+</span> <span class="n">selector</span>
            <span class="n">newMenu</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selector</span><span class="p">)</span>
    <span class="c1"># return &#39;\r\n&#39;.join(newMenu)</span>
    <span class="k">return</span> <span class="n">newMenu</span>


<span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span
                class="n">str_or_lines</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Server.* Encode a List of lines or Selector objects, or a String, as bytes to be sent by serve().</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span
                class="n">str_or_lines</span><span class="p">)</span> <span class="o">==</span> <span
                class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span
                class="n">str_or_lines</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span
                class="p">)</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span
                class="n">str_or_lines</span><span class="p">)</span> <span class="o">==</span> <span
                class="nb">list</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span
                class="n">str_or_lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span
                class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span
                class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span
                class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span
                class="se">\r\n</span><span class="s1">&#39;</span><span class="p">,</span> <span
                class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span
                class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span
                class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span
                class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span
                class="o">.</span><span class="n">endswith</span><span class="p">(</span><span
                class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span
                class="p">):</span>
                    <span class="n">line</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span
                class="s1">&#39;</span>
                <span class="n">out</span> <span class="o">+=</span> <span class="n">line</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span
                class="n">line</span><span class="p">)</span> <span class="o">==</span> <span
                class="n">Selector</span><span class="p">:</span>
                <span class="n">out</span> <span class="o">+=</span> <span class="n">line</span><span class="o">.</span><span
                class="n">source</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span
                class="n">out</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span
                class="p">)</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span
                class="n">str_or_lines</span><span class="p">)</span> <span class="o">==</span> <span
                class="nb">bytes</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">str_or_lines</span>

    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;encode() accepts items of type String, List, or Bytes.&quot;</span><span
                class="p">)</span>


<span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Server.* Default handler function for Gopher requests while hosting a server. Currently a stub.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">menu</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">Selector</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span
                class="s2">&quot;Path: &quot;</span> <span class="o">+</span> <span class="n">request</span><span
                class="o">.</span><span class="n">path</span><span class="p">),</span>
        <span class="n">Selector</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span
                class="s2">&quot;Query: &quot;</span> <span class="o">+</span> <span class="n">request</span><span
                class="o">.</span><span class="n">query</span><span class="p">),</span>
        <span class="n">Selector</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span
                class="s2">&quot;Host: &quot;</span> <span class="o">+</span> <span class="n">request</span><span
                class="o">.</span><span class="n">host</span><span class="p">),</span>
        <span class="n">Selector</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span
                class="s2">&quot;Port: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span
                class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">port</span><span
                class="p">)),</span>
        <span class="n">Selector</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span
                class="s2">&quot;Client: &quot;</span> <span class="o">+</span> <span class="n">request</span><span
                class="o">.</span><span class="n">client</span><span class="p">),</span>
        <span class="n">Selector</span><span class="p">(),</span>
        <span class="n">Selector</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span
                class="s2">&quot;This is the default Pituophis handler.&quot;</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">encode</span><span class="p">(</span><span class="n">menu</span><span
                class="p">)</span>


<span class="k">def</span> <span class="nf">serve</span><span class="p">(</span><span class="n">host</span><span
                class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span class="n">port</span><span
                class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">handler</span><span
                class="o">=</span><span class="n">handle</span><span class="p">,</span> <span class="n">tls</span><span
                class="o">=</span><span class="bp">False</span><span class="p">,</span> <span
                class="n">tlscertchainpath</span><span class="o">=</span><span
                class="s1">&#39;cacert.pem&#39;</span><span class="p">,</span>
          <span class="n">tlsprivatekeypath</span><span class="o">=</span><span
                class="s1">&#39;privkey.pem&#39;</span><span class="p">,</span> <span class="n">debug</span><span
                class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Server.*  Listens for Gopher requests. Allows for using a custom handler that will return a binary (Bytes) object</span>
<span class="sd">    to send to the client. After sending them, the finishing &quot;.&quot; is sent and the connection is closed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span
                class="n">socket</span><span class="p">(</span><span class="n">socket</span><span
                class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span
                class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span
                class="p">)</span>
    <span class="k">if</span> <span class="n">tls</span><span class="p">:</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span
                class="n">SSLContext</span><span class="p">(</span><span class="n">ssl</span><span
                class="o">.</span><span class="n">PROTOCOL_TLS_SERVER</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span
                class="o">.</span><span class="n">exists</span><span class="p">(</span><span
                class="n">tlscertchainpath</span><span class="p">)</span> <span class="ow">and</span> <span
                class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span
                class="n">exists</span><span class="p">(</span><span class="n">tlsprivatekeypath</span><span class="p">):</span>
            <span class="n">context</span><span class="o">.</span><span class="n">load_cert_chain</span><span class="p">(</span><span
                class="n">tlscertchainpath</span><span class="p">,</span> <span class="n">tlsprivatekeypath</span><span
                class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">context</span><span
                class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span
                class="n">s</span><span class="p">,</span> <span class="n">server_side</span><span
                class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;TLS certificate and/or private key is missing. TLS has been disabled for this session.&#39;</span><span
                class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Run this command to generate a self-signed certificate and private key:&#39;</span><span
                class="p">)</span>
            <span class="k">print</span><span class="p">(</span>
                <span class="s1">&#39;  openssl req -x509 -newkey rsa:4096 -keyout &quot;&#39;</span> <span
                class="o">+</span> <span class="n">tlsprivatekeypath</span> <span class="o">+</span> <span class="s1">&#39;&quot; -out &quot;&#39;</span> <span
                class="o">+</span> <span class="n">tlscertchainpath</span> <span class="o">+</span> <span class="s1">&#39;&quot; -days 365&#39;</span><span
                class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Note that clients might refuse to connect to a self-signed certificate.&#39;</span><span
                class="p">)</span>
            <span class="k">print</span><span class="p">()</span>
            <span class="n">tls</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">with</span> <span class="n">s</span><span class="p">:</span>
        <span class="n">s</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
        <span class="n">s</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tls</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;S/Gopher server is now running on&#39;</span><span
                class="p">,</span> <span class="n">host</span> <span class="o">+</span> <span
                class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span
                class="p">(</span><span class="n">port</span><span class="p">)</span> <span class="o">+</span> <span
                class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Gopher server is now running on&#39;</span><span
                class="p">,</span> <span class="n">host</span> <span class="o">+</span> <span
                class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span
                class="p">(</span><span class="n">port</span><span class="p">)</span> <span class="o">+</span> <span
                class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">conn</span><span class="p">,</span> <span class="n">addr</span> <span class="o">=</span> <span
                class="n">s</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
                <span class="k">with</span> <span class="n">conn</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                        <span class="k">print</span><span class="p">(</span><span
                class="s1">&#39;Connected by&#39;</span><span class="p">,</span> <span class="n">addr</span><span
                class="p">)</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">conn</span><span
                class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span
                class="p">)</span>
                    <span class="n">request</span> <span class="o">=</span> <span class="n">data</span><span
                class="o">.</span><span class="n">decode</span><span class="p">(</span><span
                class="s1">&#39;utf-8&#39;</span><span class="p">)</span><span class="o">.</span><span
                class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span
                class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">path</span> <span class="o">=</span> <span class="n">request</span><span
                class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span
                class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span
                class="se">\r\n</span><span class="s1">&#39;</span><span class="p">,</span> <span
                class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span
                class="n">request</span><span class="p">)</span> <span class="o">&gt;</span> <span
                class="mi">1</span><span class="p">:</span>
                        <span class="n">query</span> <span class="o">=</span> <span class="n">request</span><span
                class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span
                class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span
                class="se">\r\n</span><span class="s1">&#39;</span><span class="p">,</span> <span
                class="s1">&#39;&#39;</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                        <span class="k">print</span><span class="p">(</span><span
                class="s1">&#39;Client requests:&#39;</span><span class="p">,</span> <span class="n">path</span><span
                class="p">,</span> <span class="n">query</span><span class="p">)</span>
                    <span class="n">resp</span> <span class="o">=</span> <span class="n">handler</span><span
                class="p">(</span><span class="n">Request</span><span class="p">(</span><span class="n">path</span><span
                class="o">=</span><span class="n">path</span><span class="p">,</span> <span class="n">query</span><span
                class="o">=</span><span class="n">query</span><span class="p">,</span> <span class="n">host</span><span
                class="o">=</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span
                class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="n">client</span><span
                class="o">=</span><span class="n">addr</span><span class="p">[</span><span class="mi">0</span><span
                class="p">]))</span>
                    <span class="n">conn</span><span class="o">.</span><span class="n">send</span><span
                class="p">(</span><span class="n">resp</span><span class="p">)</span>
                    <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span
                class="p">()</span>
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                        <span class="k">print</span><span class="p">(</span><span
                class="s1">&#39;Connection closed&#39;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span
                class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Error:&#39;</span><span
                class="p">,</span> <span class="n">e</span><span class="p">)</span>
</pre></div>

  </div>

  </header>

  <section id="section-items">

    <h2 class="section-title" id="header-functions">Functions</h2>

      <div class="item">
          <div class="name def" id="pituophis.encode">
              <p>def <span class="ident">encode</span>(</p>
              <p>str_or_lines)</p>
          </div>


          <div class="desc"><p><em>Server.</em> Encode a List of lines or Selector objects, or a String, as bytes to be
              sent by serve().</p></div>
          <div class="source_cont">
              <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pituophis.encode', this);">Show
                  source &equiv;</a></p>
              <div id="source-pituophis.encode" class="source">
                  <div class="codehilite"><pre><span></span><span class="k">def</span> <span
                          class="nf">encode</span><span class="p">(</span><span class="n">str_or_lines</span><span
                          class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Server.* Encode a List of lines or Selector objects, or a String, as bytes to be sent by serve().</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span
                              class="n">str_or_lines</span><span class="p">)</span> <span class="o">==</span> <span
                              class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span
                              class="n">str_or_lines</span><span class="p">,</span> <span
                              class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span
                              class="n">str_or_lines</span><span class="p">)</span> <span class="o">==</span> <span
                              class="nb">list</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span
                              class="n">str_or_lines</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span
                              class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span
                              class="p">:</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span
                              class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span
                              class="se">\r\n</span><span class="s1">&#39;</span><span class="p">,</span> <span
                              class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span
                              class="p">)</span>
                <span class="n">line</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span
                              class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span
                              class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span
                              class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span
                              class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">line</span><span
                              class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;</span><span
                              class="se">\r\n</span><span class="s1">&#39;</span><span class="p">):</span>
                    <span class="n">line</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span
                              class="s1">&#39;</span>
                <span class="n">out</span> <span class="o">+=</span> <span class="n">line</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span
                              class="n">line</span><span class="p">)</span> <span class="o">==</span> <span class="n">Selector</span><span
                              class="p">:</span>
                <span class="n">out</span> <span class="o">+=</span> <span class="n">line</span><span class="o">.</span><span
                              class="n">source</span><span class="p">()</span>
        <span class="k">return</span> <span class="nb">bytes</span><span class="p">(</span><span
                              class="n">out</span><span class="p">,</span> <span class="s1">&#39;utf-8&#39;</span><span
                              class="p">)</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span
                              class="n">str_or_lines</span><span class="p">)</span> <span class="o">==</span> <span
                              class="nb">bytes</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">str_or_lines</span>

    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;encode() accepts items of type String, List, or Bytes.&quot;</span><span
                              class="p">)</span>
</pre>
                  </div>

              </div>
          </div>

      </div>


      <div class="item">
    <div class="name def" id="pituophis.get">
        <p>def <span class="ident">get</span>(</p>
        <p>host, port=70, path=&#39;/&#39;, query=&#39;&#39;, tls=False, tls_verify=True)</p>
    </div>


          <div class="desc"><p><em>Client.</em> Quickly creates and sends a Request. Returns a Response object.</p>
          </div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pituophis.get', this);">Show source &equiv;</a></p>
  <div id="source-pituophis.get" class="source">
      <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get</span><span
              class="p">(</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span
              class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">path</span><span
              class="o">=</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">query</span><span
              class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span
              class="n">tls</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span
              class="n">tls_verify</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Client.* Quickly creates and sends a Request. Returns a Response object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span
                  class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span> <span
                  class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span
                  class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span
                  class="n">query</span><span class="o">=</span><span class="n">query</span><span
                  class="p">,</span> <span class="n">tls</span><span class="o">=</span><span class="n">tls</span><span
                  class="p">,</span> <span class="n">tls_verify</span><span class="o">=</span><span
                  class="n">tls_verify</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;/&#39;</span> <span class="ow">in</span> <span class="n">host</span> <span
                  class="ow">or</span> <span class="s1">&#39;:&#39;</span> <span class="ow">in</span> <span class="n">host</span><span
                  class="p">:</span>
        <span class="n">req</span> <span class="o">=</span> <span class="n">parse_url</span><span class="p">(</span><span class="n">host</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">req</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="pituophis.handle">
    <p>def <span class="ident">handle</span>(</p><p>request)</p>
    </div>


      <div class="desc"><p><em>Server.</em> Default handler function for Gopher requests while hosting a server.
          Currently a stub.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pituophis.handle', this);">Show source &equiv;</a></p>
  <div id="source-pituophis.handle" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">handle</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Server.* Default handler function for Gopher requests while hosting a server. Currently a stub.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">menu</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">Selector</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span
                class="s2">&quot;Path: &quot;</span> <span class="o">+</span> <span class="n">request</span><span
                class="o">.</span><span class="n">path</span><span class="p">),</span>
        <span class="n">Selector</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span
                class="s2">&quot;Query: &quot;</span> <span class="o">+</span> <span class="n">request</span><span
                class="o">.</span><span class="n">query</span><span class="p">),</span>
        <span class="n">Selector</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span
                class="s2">&quot;Host: &quot;</span> <span class="o">+</span> <span class="n">request</span><span
                class="o">.</span><span class="n">host</span><span class="p">),</span>
        <span class="n">Selector</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span
                class="s2">&quot;Port: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span
                class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">port</span><span
                class="p">)),</span>
        <span class="n">Selector</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span
                class="s2">&quot;Client: &quot;</span> <span class="o">+</span> <span class="n">request</span><span
                class="o">.</span><span class="n">client</span><span class="p">),</span>
        <span class="n">Selector</span><span class="p">(),</span>
        <span class="n">Selector</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span
                class="s2">&quot;This is the default Pituophis handler.&quot;</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="k">return</span> <span class="n">encode</span><span class="p">(</span><span class="n">menu</span><span
                class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="pituophis.parse_gophermap">
        <p>def <span class="ident">parse_gophermap</span>(</p>
        <p>source, defHost=&#39;127.0.0.1&#39;, defPort=&#39;70&#39;)</p>
    </div>


      <div class="desc"><p><em>Server.</em> Converts a Gophermap (as a String or List) into a Gopher menu. Returns a
          List of lines to send.
This is <em>not</em> as feature-complete as the actual Bucktooth implementation; one example being how paths
          are not resolved. It does, however, fill in missing selector, host, and port fields,
          given that the correct host and port values are passed to it.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pituophis.parse_gophermap', this);">Show source &equiv;</a></p>
  <div id="source-pituophis.parse_gophermap" class="source">
      <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">parse_gophermap</span><span
              class="p">(</span><span class="n">source</span><span class="p">,</span> <span
              class="n">defHost</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span
              class="p">,</span> <span class="n">defPort</span><span class="o">=</span><span
              class="s1">&#39;70&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Server.* Converts a Gophermap (as a String or List) into a Gopher menu. Returns a List of lines to send.</span>
<span class="sd">    This is *not* as feature-complete as the actual Bucktooth implementation; one example being how paths</span>
<span class="sd">    are not resolved. It does, however, fill in missing selector, host, and port fields,</span>
<span class="sd">    given that the correct host and port values are passed to it.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># NOTICE:</span>
    <span class="c1"># Relative links are *not* fixed with this function!</span>
    <span class="c1"># The path isn&#39;t ever touched, so this is more for convenience of making menus</span>
    <span class="c1"># (filling in the blank fields, information selectors...)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">source</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">source</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">newMenu</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">selector</span> <span class="ow">in</span> <span class="n">source</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="ow">in</span> <span class="n">selector</span><span class="p">:</span>
            <span class="c1"># this is not information</span>
            <span class="n">selector</span> <span class="o">=</span> <span class="n">selector</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="c1"># 1Text    pictures/    host.host    port</span>
            <span class="c1">#  ^           ^           ^           ^</span>
            <span class="n">itype</span> <span class="o">=</span> <span class="n">selector</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">text</span> <span class="o">=</span> <span class="n">selector</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">selector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span>
            <span class="n">host</span> <span class="o">=</span> <span class="n">defHost</span>
            <span class="n">port</span> <span class="o">=</span> <span class="n">defPort</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selector</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">path</span> <span class="o">=</span> <span class="n">selector</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selector</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">host</span> <span class="o">=</span> <span class="n">selector</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">selector</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
                <span class="n">port</span> <span class="o">=</span> <span class="n">selector</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

            <span class="n">selector</span> <span class="o">=</span> <span class="p">[</span><span class="n">itype</span> <span class="o">+</span> <span class="n">text</span><span class="p">,</span> <span class="n">path</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">]</span>
            <span class="n">newMenu</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">selector</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">selector</span> <span class="o">=</span> <span class="s1">&#39;i&#39;</span> <span class="o">+</span> <span class="n">selector</span>
            <span class="n">newMenu</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">selector</span><span class="p">)</span>
    <span class="c1"># return &#39;\r\n&#39;.join(newMenu)</span>
    <span class="k">return</span> <span class="n">newMenu</span>
</pre></div>

  </div>
</div>

  </div>


      <div class="item">
          <div class="name def" id="pituophis.parse_menu">
              <p>def <span class="ident">parse_menu</span>(</p>
              <p>source)</p>
          </div>


          <div class="desc"><p><em>Client.</em> Parses a String as a Gopher menu. Returns a List of Selectors.</p></div>
          <div class="source_cont">
              <p class="source_link"><a href="javascript:void(0);"
                                        onclick="toggle('source-pituophis.parse_menu', this);">Show source &equiv;</a>
              </p>
              <div id="source-pituophis.parse_menu" class="source">
                  <div class="codehilite"><pre><span></span><span class="k">def</span> <span
                          class="nf">parse_menu</span><span class="p">(</span><span class="n">source</span><span
                          class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Client.* Parses a String as a Gopher menu. Returns a List of Selectors.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">parsed_menu</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">menu</span> <span class="o">=</span> <span class="n">source</span><span class="o">.</span><span
                              class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span
                              class="se">\r\n</span><span class="s1">&#39;</span><span class="p">,</span> <span
                              class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span
                              class="p">)</span><span class="o">.</span><span class="n">replace</span><span
                              class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span
                              class="p">,</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span
                              class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span
                              class="p">(</span><span class="s1">&#39;</span><span class="se">\r\n</span><span
                              class="s1">&#39;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">menu</span><span
                              class="p">:</span>
        <span class="n">selector</span> <span class="o">=</span> <span class="n">Selector</span><span
                              class="p">()</span>
        <span class="k">if</span> <span class="n">line</span><span class="o">.</span><span
                              class="n">startswith</span><span class="p">(</span><span
                              class="s1">&#39;i&#39;</span><span class="p">):</span>
            <span class="n">selector</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span
                              class="s1">&#39;i&#39;</span>
            <span class="n">selector</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span
                              class="n">line</span><span class="p">[</span><span class="mi">1</span><span
                              class="p">:]</span><span class="o">.</span><span class="n">split</span><span
                              class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span
                              class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">selector</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span
                              class="s1">&#39;/&#39;</span>
            <span class="n">selector</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span
                              class="s1">&#39;error.host&#39;</span>
            <span class="n">selector</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span
                              class="mi">0</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">matches</span> <span class="o">=</span> <span class="n">re</span><span
                              class="o">.</span><span class="n">match</span><span class="p">(</span><span
                              class="sa">r</span><span class="s1">&#39;^(.)(.*)\t(.*)\t(.*)\t(.*)&#39;</span><span
                              class="p">,</span> <span class="n">line</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">matches</span><span class="p">:</span>
                <span class="n">selector</span><span class="o">.</span><span class="n">type</span> <span
                              class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="mi">1</span><span
                              class="p">]</span>
                <span class="n">selector</span><span class="o">.</span><span class="n">text</span> <span
                              class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="mi">2</span><span
                              class="p">]</span>
                <span class="n">selector</span><span class="o">.</span><span class="n">path</span> <span
                              class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="mi">3</span><span
                              class="p">]</span>
                <span class="n">selector</span><span class="o">.</span><span class="n">host</span> <span
                              class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="mi">4</span><span
                              class="p">]</span>
                <span class="n">selector</span><span class="o">.</span><span class="n">port</span> <span
                              class="o">=</span> <span class="n">matches</span><span class="p">[</span><span class="mi">5</span><span
                              class="p">]</span>
                <span class="c1"># detect TLS</span>
                <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span
                              class="n">selector</span><span class="o">.</span><span class="n">port</span><span
                              class="p">)</span> <span class="o">&gt;</span> <span class="mi">65535</span><span
                              class="p">:</span>
                    <span class="n">selector</span><span class="o">.</span><span class="n">tls</span> <span
                              class="o">=</span> <span class="bp">True</span>
                    <span class="c1"># typically the port is sent as 100105</span>
                    <span class="c1"># remove first number to get at 5 digits</span>
                    <span class="n">selector</span><span class="o">.</span><span class="n">port</span> <span
                              class="o">=</span> <span class="nb">int</span><span class="p">(</span><span
                              class="nb">str</span><span class="p">(</span><span class="n">selector</span><span
                              class="o">.</span><span class="n">port</span><span class="p">)[</span><span
                              class="mi">1</span><span class="p">:])</span>
        <span class="n">parsed_menu</span><span class="o">.</span><span class="n">append</span><span
                              class="p">(</span><span class="n">selector</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">parsed_menu</span>
</pre>
                  </div>

              </div>
          </div>

      </div>


      <div class="item">
    <div class="name def" id="pituophis.parse_url">
    <p>def <span class="ident">parse_url</span>(</p><p>url)</p>
    </div>


          <div class="desc"><p><em>Client.</em> Parses a Gopher URL and returns an equivalent Request.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pituophis.parse_url', this);">Show source &equiv;</a></p>
  <div id="source-pituophis.parse_url" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">parse_url</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Client.* Parses a Gopher URL and returns an equivalent Request.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">req</span> <span class="o">=</span> <span class="n">Request</span><span class="p">(</span><span class="n">host</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">tls</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>

    <span class="c1"># condense multiple slashes to one</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;/+&#39;</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
    <span class="c1"># add protocol if not there</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="s1">&#39;:/&#39;</span> <span
                class="ow">in</span> <span class="n">url</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;gopher:/&#39;</span> <span
                class="o">+</span> <span class="n">url</span>
    <span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)</span>
    <span class="c1"># split into protocol, host &amp; port, and then the following items for the selector/path</span>
    <span class="c1"># gopher:</span>
    <span class="c1"># gopher.floodgap.com:70</span>
    <span class="c1"># gopher/</span>
    <span class="c1"># detect tls and remove protocol</span>
    <span class="k">if</span> <span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;gophers:&#39;</span><span class="p">:</span>
            <span class="n">req</span><span class="o">.</span><span class="n">tls</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">url</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># set and remove host/port</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">req</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">req</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span
                class="nb">int</span><span class="p">(</span><span class="n">url</span><span class="p">[</span><span
                class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span
                class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span
                class="mi">1</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">req</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">url</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="c1"># remove selector if it is there</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">url</span><span
                class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">url</span><span
                class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span
                class="mi">1</span><span class="p">:</span>
            <span class="n">req</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span
                class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">url</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span
                class="mi">0</span><span class="p">)</span>
    <span class="c1"># set url to path?query</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="n">req</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">url</span>
    <span class="c1"># split query if it is there</span>
    <span class="k">if</span> <span class="s1">&#39;?&#39;</span> <span class="ow">in</span> <span class="n">url</span><span class="p">:</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;?&#39;</span><span class="p">)</span>
        <span class="n">req</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">url</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">req</span><span class="o">.</span><span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">req</span>
</pre></div>

  </div>
</div>

  </div>
  
      
  <div class="item">
    <div class="name def" id="pituophis.serve">
        <p>def <span class="ident">serve</span>(</p>
        <p>host=&#39;127.0.0.1&#39;, port=70, handler=&lt;function handle at 0x10fba3840&gt;, tls=False,
            tlscertchainpath=&#39;cacert.pem&#39;, tlsprivatekeypath=&#39;privkey.pem&#39;, debug=True)</p>
    </div>


      <div class="desc"><p><em>Server.</em> Listens for Gopher requests. Allows for using a custom handler that will
          return a binary (Bytes) object
          to send to the client. After sending them, the finishing "." is sent and the connection is closed.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pituophis.serve', this);">Show source &equiv;</a></p>
  <div id="source-pituophis.serve" class="source">
      <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">serve</span><span class="p">(</span><span
              class="n">host</span><span class="o">=</span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span> <span
              class="n">port</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span
              class="n">handler</span><span class="o">=</span><span class="n">handle</span><span
              class="p">,</span> <span class="n">tls</span><span class="o">=</span><span class="bp">False</span><span
              class="p">,</span> <span class="n">tlscertchainpath</span><span class="o">=</span><span class="s1">&#39;cacert.pem&#39;</span><span
              class="p">,</span>
          <span class="n">tlsprivatekeypath</span><span class="o">=</span><span
                  class="s1">&#39;privkey.pem&#39;</span><span class="p">,</span> <span class="n">debug</span><span
                  class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Server.*  Listens for Gopher requests. Allows for using a custom handler that will return a binary (Bytes) object</span>
<span class="sd">    to send to the client. After sending them, the finishing &quot;.&quot; is sent and the connection is closed.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span
                  class="n">socket</span><span class="p">(</span><span class="n">socket</span><span
                  class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span
                  class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">tls</span><span class="p">:</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span
                  class="n">SSLContext</span><span class="p">(</span><span class="n">ssl</span><span
                  class="o">.</span><span class="n">PROTOCOL_TLS_SERVER</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span
                  class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">tlscertchainpath</span><span
                  class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span
                  class="n">path</span><span class="o">.</span><span class="n">exists</span><span
                  class="p">(</span><span class="n">tlsprivatekeypath</span><span class="p">):</span>
            <span class="n">context</span><span class="o">.</span><span class="n">load_cert_chain</span><span class="p">(</span><span
                  class="n">tlscertchainpath</span><span class="p">,</span> <span
                  class="n">tlsprivatekeypath</span><span class="p">)</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">context</span><span
                  class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span
                  class="n">s</span><span class="p">,</span> <span class="n">server_side</span><span
                  class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;TLS certificate and/or private key is missing. TLS has been disabled for this session.&#39;</span><span
                  class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Run this command to generate a self-signed certificate and private key:&#39;</span><span
                  class="p">)</span>
            <span class="k">print</span><span class="p">(</span>
                <span class="s1">&#39;  openssl req -x509 -newkey rsa:4096 -keyout &quot;&#39;</span> <span
                  class="o">+</span> <span class="n">tlsprivatekeypath</span> <span class="o">+</span> <span class="s1">&#39;&quot; -out &quot;&#39;</span> <span
                  class="o">+</span> <span class="n">tlscertchainpath</span> <span class="o">+</span> <span class="s1">&#39;&quot; -days 365&#39;</span><span
                  class="p">)</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Note that clients might refuse to connect to a self-signed certificate.&#39;</span><span
                  class="p">)</span>
            <span class="k">print</span><span class="p">()</span>
            <span class="n">tls</span> <span class="o">=</span> <span class="bp">False</span>

    <span class="k">with</span> <span class="n">s</span><span class="p">:</span>
        <span class="n">s</span><span class="o">.</span><span class="n">bind</span><span class="p">((</span><span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">))</span>
        <span class="n">s</span><span class="o">.</span><span class="n">listen</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">tls</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;S/Gopher server is now running on&#39;</span><span
                  class="p">,</span> <span class="n">host</span> <span class="o">+</span> <span
                  class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span
                  class="p">(</span><span class="n">port</span><span class="p">)</span> <span class="o">+</span> <span
                  class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Gopher server is now running on&#39;</span><span
                  class="p">,</span> <span class="n">host</span> <span class="o">+</span> <span
                  class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span
                  class="p">(</span><span class="n">port</span><span class="p">)</span> <span class="o">+</span> <span
                  class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">conn</span><span class="p">,</span> <span class="n">addr</span> <span class="o">=</span> <span
                  class="n">s</span><span class="o">.</span><span class="n">accept</span><span class="p">()</span>
                <span class="k">with</span> <span class="n">conn</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                        <span class="k">print</span><span class="p">(</span><span
                  class="s1">&#39;Connected by&#39;</span><span class="p">,</span> <span class="n">addr</span><span
                  class="p">)</span>
                    <span class="n">data</span> <span class="o">=</span> <span class="n">conn</span><span
                  class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">1024</span><span
                  class="p">)</span>
                    <span class="n">request</span> <span class="o">=</span> <span class="n">data</span><span
                  class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span
                  class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span
                  class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span>
                    <span class="n">path</span> <span class="o">=</span> <span class="n">request</span><span
                  class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span
                  class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span
                  class="se">\r\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span
                  class="p">)</span>
                    <span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
                    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span
                  class="n">request</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span
                  class="p">:</span>
                        <span class="n">query</span> <span class="o">=</span> <span class="n">request</span><span
                  class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span
                  class="n">replace</span><span class="p">(</span><span class="s1">&#39;</span><span
                  class="se">\r\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span
                  class="p">)</span>
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                        <span class="k">print</span><span class="p">(</span><span
                  class="s1">&#39;Client requests:&#39;</span><span class="p">,</span> <span class="n">path</span><span
                  class="p">,</span> <span class="n">query</span><span class="p">)</span>
                    <span class="n">resp</span> <span class="o">=</span> <span class="n">handler</span><span
                  class="p">(</span><span class="n">Request</span><span class="p">(</span><span
                  class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">,</span> <span
                  class="n">query</span><span class="o">=</span><span class="n">query</span><span
                  class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">host</span><span
                  class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="n">port</span><span
                  class="p">,</span> <span class="n">client</span><span class="o">=</span><span
                  class="n">addr</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
                    <span class="n">conn</span><span class="o">.</span><span class="n">send</span><span
                  class="p">(</span><span class="n">resp</span><span class="p">)</span>
                    <span class="n">conn</span><span class="o">.</span><span class="n">close</span><span
                  class="p">()</span>
                    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                        <span class="k">print</span><span class="p">(</span><span
                  class="s1">&#39;Connection closed&#39;</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span
                  class="n">e</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                    <span class="k">print</span><span class="p">(</span><span class="s1">&#39;Error:&#39;</span><span
                  class="p">,</span> <span class="n">e</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  

    <h2 class="section-title" id="header-classes">Classes</h2>
      
      <div class="item">
      <p id="pituophis.Request" class="name">class <span class="ident">Request</span></p>
      
  
    <div class="desc"><p><em>Client/Server.</em> Represents a request to be sent to a Gopher server, or received from a client.</p>
        <p>The type property is not used when sending or receiving requests; it's purely for client-side usage.
            The tls_verify property determines if the client will trust a self-signed certificate when using TLS.</p>
    </div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pituophis.Request', this);">Show source &equiv;</a></p>
  <div id="source-pituophis.Request" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Request</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Client/Server.* Represents a request to be sent to a Gopher server, or received from a client.</span>

<span class="sd">    The type property is not used when sending or receiving requests; it&#39;s purely for client-side usage.</span>
<span class="sd">    The tls_verify property determines if the client will trust a self-signed certificate when using TLS.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span
                class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span
                class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">70</span><span
                class="p">,</span> <span class="n">path</span><span class="o">=</span><span
                class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">query</span><span
                class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span
                class="n">itype</span><span class="o">=</span><span class="s1">&#39;9&#39;</span><span
                class="p">,</span> <span class="n">tls</span><span class="o">=</span><span class="bp">False</span><span
                class="p">,</span> <span class="n">tls_verify</span><span class="o">=</span><span class="bp">True</span><span
                class="p">,</span> <span class="n">client</span><span class="o">=</span><span
                class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes a new Request object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span
                class="nb">str</span><span class="p">(</span><span class="n">host</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Client/Server.* The hostname of the server.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span
                class="nb">int</span><span class="p">(</span><span class="n">port</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Client/Server.* The port of the server. For regular Gopher servers, this is most commonly 70, </span>
<span class="sd">        and for S/Gopher servers it is typically 105.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span
                class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Client/Server.* Path on the target server to request, or being requested.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tls</span> <span class="o">=</span> <span
                class="n">tls</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Client.* Whether the target server is an S/Gopher server with TLS enabled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">=</span> <span
                class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Client/Server.* Search query for the server to process. Omitted when blank.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span
                class="nb">str</span><span class="p">(</span><span class="n">itype</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Client.* Item type of the request. Purely for client-side usage.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tls</span> <span class="o">=</span> <span
                class="n">tls</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Client.* Whether the request is to be sent to an S/Gopher server over TLS.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tls_verify</span> <span
                class="o">=</span> <span class="n">tls_verify</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Client.* Whether to verify the certificate sent from the server, rejecting self-signed and invalid certificates.</span>
<span class="sd">        ***Currently stuck on True in some functions.***</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span
                class="nb">str</span><span class="p">(</span><span class="n">client</span><span
                class="p">)</span>  <span class="c1"># only used in server</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        *Server.* The IP address of the connected client.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sends the Request and returns a Response object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tls</span><span class="p">:</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span
                class="o">.</span><span class="n">_create_unverified_context</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span
                class="n">tls_verify</span><span class="p">:</span>  <span class="c1"># TODO: for some reason this is always true when using the get() shorthand</span>
                <span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span
                class="o">.</span><span class="n">create_default_context</span><span class="p">()</span>
            <span class="n">s</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">server_hostname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">s</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>
        <span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span
                class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span
                class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span
                class="n">port</span><span class="p">)))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span>
        <span class="n">s</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">makefile</span><span class="p">(</span><span class="s1">&#39;rb&#39;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a URL equivalent to the Request&#39;s properties.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">protocol</span> <span class="o">=</span> <span class="s1">&#39;gopher&#39;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tls</span><span class="p">:</span>
            <span class="n">protocol</span> <span class="o">=</span> <span class="s1">&#39;gophers&#39;</span>
        <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)):</span>
            <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">path</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
            <span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span>
        <span class="k">return</span> <span class="n">protocol</span> <span class="o">+</span> <span class="s1">&#39;://&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#pituophis.Request">Request</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="pituophis.Request.__init__">
        <p>def <span class="ident">__init__</span>(</p>
        <p>self, host=&#39;127.0.0.1&#39;, port=70, path=&#39;/&#39;, query=&#39;&#39;, itype=&#39;9&#39;, tls=False,
            tls_verify=True, client=&#39;&#39;)</p>
    </div>
    

    
  
    <div class="desc"><p>Initializes a new Request object.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pituophis.Request.__init__', this);">Show source &equiv;</a></p>
  <div id="source-pituophis.Request.__init__" class="source">
      <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span
              class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">host</span><span
              class="o">=</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="p">,</span> <span
              class="n">port</span><span class="o">=</span><span class="mi">70</span><span class="p">,</span> <span
              class="n">path</span><span class="o">=</span><span class="s1">&#39;/&#39;</span><span
              class="p">,</span> <span class="n">query</span><span class="o">=</span><span
              class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">itype</span><span
              class="o">=</span><span class="s1">&#39;9&#39;</span><span class="p">,</span> <span
              class="n">tls</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span
              class="n">tls_verify</span><span class="o">=</span><span class="bp">True</span><span
              class="p">,</span> <span class="n">client</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span
              class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes a new Request object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span
                  class="nb">str</span><span class="p">(</span><span class="n">host</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Client/Server.* The hostname of the server.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span
                  class="nb">int</span><span class="p">(</span><span class="n">port</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Client/Server.* The port of the server. For regular Gopher servers, this is most commonly 70, </span>
<span class="sd">    and for S/Gopher servers it is typically 105.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span
                  class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Client/Server.* Path on the target server to request, or being requested.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tls</span> <span class="o">=</span> <span
                  class="n">tls</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Client.* Whether the target server is an S/Gopher server with TLS enabled.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">=</span> <span
                  class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Client/Server.* Search query for the server to process. Omitted when blank.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span
                  class="nb">str</span><span class="p">(</span><span class="n">itype</span><span class="p">)</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Client.* Item type of the request. Purely for client-side usage.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tls</span> <span class="o">=</span> <span
                  class="n">tls</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Client.* Whether the request is to be sent to an S/Gopher server over TLS.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tls_verify</span> <span class="o">=</span> <span
                  class="n">tls_verify</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Client.* Whether to verify the certificate sent from the server, rejecting self-signed and invalid certificates.</span>
<span class="sd">    ***Currently stuck on True in some functions.***</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">client</span> <span class="o">=</span> <span
                  class="nb">str</span><span class="p">(</span><span class="n">client</span><span
                  class="p">)</span>  <span class="c1"># only used in server</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Server.* The IP address of the connected client.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pituophis.Request.get">
    <p>def <span class="ident">get</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Sends the Request and returns a Response object.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pituophis.Request.get', this);">Show source &equiv;</a></p>
  <div id="source-pituophis.Request.get" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">get</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sends the Request and returns a Response object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tls</span><span class="p">:</span>
        <span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span
                class="n">_create_unverified_context</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span
                class="n">tls_verify</span><span class="p">:</span>  <span class="c1"># TODO: for some reason this is always true when using the get() shorthand</span>
            <span class="n">context</span> <span class="o">=</span> <span class="n">ssl</span><span
                class="o">.</span><span class="n">create_default_context</span><span class="p">()</span>
        <span class="n">s</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">server_hostname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">s</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span>
    <span class="n">s</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span
                class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">,</span> <span
                class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span
                class="n">port</span><span class="p">)))</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">+</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span>
    <span class="n">s</span><span class="o">.</span><span class="n">sendall</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">makefile</span><span class="p">(</span><span class="s1">&#39;rb&#39;</span><span class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pituophis.Request.url">
    <p>def <span class="ident">url</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns a URL equivalent to the Request's properties.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pituophis.Request.url', this);">Show source &equiv;</a></p>
  <div id="source-pituophis.Request.url" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">url</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a URL equivalent to the Request&#39;s properties.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">protocol</span> <span class="o">=</span> <span class="s1">&#39;gopher&#39;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">tls</span><span class="p">:</span>
        <span class="n">protocol</span> <span class="o">=</span> <span class="s1">&#39;gophers&#39;</span>
    <span class="n">path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">path</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)):</span>
        <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">path</span>
    <span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">query</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">):</span>
        <span class="n">query</span> <span class="o">=</span> <span class="s1">&#39;?&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">query</span>
    <span class="k">return</span> <span class="n">protocol</span> <span class="o">+</span> <span class="s1">&#39;://&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="pituophis.Request.client" class="name">var <span class="ident">client</span></p>


                <div class="desc"><p><em>Server.</em> The IP address of the connected client.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pituophis.Request.host" class="name">var <span class="ident">host</span></p>


                <div class="desc"><p><em>Client/Server.</em> The hostname of the server.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pituophis.Request.path" class="name">var <span class="ident">path</span></p>


                <div class="desc"><p><em>Client/Server.</em> Path on the target server to request, or being requested.
                </p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pituophis.Request.port" class="name">var <span class="ident">port</span></p>


                <div class="desc"><p><em>Client/Server.</em> The port of the server. For regular Gopher servers, this is
                    most commonly 70,
                    and for S/Gopher servers it is typically 105.</p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pituophis.Request.query" class="name">var <span class="ident">query</span></p>


                <div class="desc"><p><em>Client/Server.</em> Search query for the server to process. Omitted when blank.
                </p></div>
  <div class="source_cont">
</div>

            </div>
            <div class="item">
            <p id="pituophis.Request.tls" class="name">var <span class="ident">tls</span></p>


                <div class="desc"><p><em>Client.</em> Whether the request is to be sent to an S/Gopher server over TLS.
                </p></div>
                <div class="source_cont">
                </div>

            </div>
          <div class="item">
              <p id="pituophis.Request.tls_verify" class="name">var <span class="ident">tls_verify</span></p>


              <div class="desc"><p><em>Client.</em> Whether to verify the certificate sent from the server, rejecting
                  self-signed and invalid certificates.
                  <strong><em>Currently stuck on True in some functions.</em></strong></p></div>
              <div class="source_cont">
</div>

          </div>
            <div class="item">
            <p id="pituophis.Request.type" class="name">var <span class="ident">type</span></p>


                <div class="desc"><p><em>Client.</em> Item type of the request. Purely for client-side usage.</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="pituophis.Response" class="name">class <span class="ident">Response</span></p>


          <div class="desc"><p><em>Client.</em> Returned by Request.get() and get(). Represents a received binary object
              from a Gopher server.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pituophis.Response', this);">Show source &equiv;</a></p>
  <div id="source-pituophis.Response" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Response</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Client.* Returned by Request.get() and get(). Represents a received binary object from a Gopher server.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Reads a BufferedReader to the object&#39;s binary property and initializes a new Response object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">binary</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The data received from the server as a Bytes binary object.</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns the binary decoded as a UTF-8 String.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Decodes the binary as text and parses it as a Gopher menu. Returns a List of Gopher menu items parsed as the Selector type.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">parse_menu</span><span class="p">(</span><span
                class="bp">self</span><span class="o">.</span><span class="n">binary</span><span class="o">.</span><span
                class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span
                class="p">))</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#pituophis.Response">Response</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="pituophis.Response.__init__">
    <p>def <span class="ident">__init__</span>(</p><p>self, stream)</p>
    </div>
    

    
  
    <div class="desc"><p>Reads a BufferedReader to the object's binary property and initializes a new Response object.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pituophis.Response.__init__', this);">Show source &equiv;</a></p>
  <div id="source-pituophis.Response.__init__" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">stream</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Reads a BufferedReader to the object&#39;s binary property and initializes a new Response object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">binary</span> <span class="o">=</span> <span class="n">stream</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The data received from the server as a Bytes binary object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pituophis.Response.menu">
    <p>def <span class="ident">menu</span>(</p><p>self)</p>
    </div>


      <div class="desc"><p>Decodes the binary as text and parses it as a Gopher menu. Returns a List of Gopher menu
          items parsed as the Selector type.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pituophis.Response.menu', this);">Show source &equiv;</a></p>
  <div id="source-pituophis.Response.menu" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">menu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Decodes the binary as text and parses it as a Gopher menu. Returns a List of Gopher menu items parsed as the Selector type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">parse_menu</span><span class="p">(</span><span
                class="bp">self</span><span class="o">.</span><span class="n">binary</span><span class="o">.</span><span
                class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span
                class="p">))</span>
</pre></div>

  </div>
</div>

  </div>
  
            
  <div class="item">
    <div class="name def" id="pituophis.Response.text">
    <p>def <span class="ident">text</span>(</p><p>self)</p>
    </div>
    

    
  
    <div class="desc"><p>Returns the binary decoded as a UTF-8 String.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pituophis.Response.text', this);">Show source &equiv;</a></p>
  <div id="source-pituophis.Response.text" class="source">
    <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="nf">text</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns the binary decoded as a UTF-8 String.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">binary</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
</pre></div>

  </div>
</div>

  </div>
  
          <h3>Instance variables</h3>
            <div class="item">
            <p id="pituophis.Response.binary" class="name">var <span class="ident">binary</span></p>


                <div class="desc"><p>The data received from the server as a Bytes binary object.</p></div>
  <div class="source_cont">
</div>

            </div>
      </div>
      </div>
      
      <div class="item">
      <p id="pituophis.Selector" class="name">class <span class="ident">Selector</span></p>


          <div class="desc"><p><em>Server/Client.</em> Represents a selector in a parsed Gopher menu.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pituophis.Selector', this);">Show source &equiv;</a></p>
  <div id="source-pituophis.Selector" class="source">
    <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Selector</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    *Server/Client.* Represents a selector in a parsed Gopher menu.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span
                class="p">,</span> <span class="n">itype</span><span class="o">=</span><span
                class="s1">&#39;i&#39;</span><span class="p">,</span> <span class="n">text</span><span
                class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">path</span><span
                class="o">=</span><span class="s1">&#39;/&#39;</span><span class="p">,</span> <span
                class="n">host</span><span class="o">=</span><span class="s1">&#39;error.host&#39;</span><span
                class="p">,</span> <span class="n">port</span><span class="o">=</span><span class="mi">0</span><span
                class="p">,</span> <span class="n">tls</span><span class="o">=</span><span class="bp">False</span><span
                class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes a new Selector object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span
                class="n">itype</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The type of item.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span
                class="n">text</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The name, or text that is displayed when the item is in a menu.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span
                class="n">path</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Where the item links to on the target server.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span
                class="n">host</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The hostname of the target server.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span
                class="n">port</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The port of the target server. For regular Gopher servers, this is most commonly 70, </span>
<span class="sd">        and for S/Gopher servers it is typically 105.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tls</span> <span class="o">=</span> <span
                class="n">tls</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        True if the selector leads to an S/Gopher server with TLS enabled.</span>
<span class="sd">        &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">source</span><span class="p">(</span><span class="bp">self</span><span
                class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a representation of what the selector looks like in a Gopher menu.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span
                class="bp">self</span><span class="o">.</span><span class="n">port</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">port</span> <span class="o">&lt;</span> <span
                class="mi">65535</span><span class="p">:</span>
            <span class="c1"># Add digits to display that this is a TLS selector</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span
                class="nb">str</span><span class="p">(</span><span class="n">port</span><span class="p">))</span> <span
                class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
                <span class="n">port</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span> <span
                class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">port</span><span
                class="p">)</span>
            <span class="n">port</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span> <span
                class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">port</span><span
                class="p">)</span>
            <span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span
                class="p">(</span><span class="n">port</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span
                class="bp">self</span><span class="o">.</span><span class="n">type</span><span class="p">)</span> <span
                class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span
                class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="o">+</span> <span
                class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span
                class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span
                class="n">path</span><span class="p">)</span> <span class="o">+</span> <span
                class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span
                class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span
                class="n">host</span><span class="p">)</span> <span class="o">+</span> <span
                class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span
                class="nb">str</span><span class="p">(</span>
            <span class="n">port</span><span class="p">)</span> <span class="o">+</span> <span
                class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span>
</pre></div>

  </div>
</div>


      <div class="class">
          <h3>Ancestors (in MRO)</h3>
          <ul class="class_list">
          <li><a href="#pituophis.Selector">Selector</a></li>
          <li>builtins.object</li>
          </ul>
          <h3>Static methods</h3>
            
  <div class="item">
    <div class="name def" id="pituophis.Selector.__init__">
        <p>def <span class="ident">__init__</span>(</p>
        <p>self, itype=&#39;i&#39;, text=&#39;&#39;, path=&#39;/&#39;, host=&#39;error.host&#39;, port=0, tls=False)</p>
    </div>


      <div class="desc"><p>Initializes a new Selector object.</p></div>
  <div class="source_cont">
  <p class="source_link"><a href="javascript:void(0);" onclick="toggle('source-pituophis.Selector.__init__', this);">Show source &equiv;</a></p>
  <div id="source-pituophis.Selector.__init__" class="source">
      <div class="codehilite"><pre><span></span><span class="k">def</span> <span class="fm">__init__</span><span
              class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itype</span><span
              class="o">=</span><span class="s1">&#39;i&#39;</span><span class="p">,</span> <span
              class="n">text</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span
              class="p">,</span> <span class="n">path</span><span class="o">=</span><span
              class="s1">&#39;/&#39;</span><span class="p">,</span> <span class="n">host</span><span
              class="o">=</span><span class="s1">&#39;error.host&#39;</span><span class="p">,</span> <span class="n">port</span><span
              class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">tls</span><span
              class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initializes a new Selector object.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span
                  class="n">itype</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The type of item.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span
                  class="n">text</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The name, or text that is displayed when the item is in a menu.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">path</span> <span class="o">=</span> <span
                  class="n">path</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Where the item links to on the target server.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">host</span> <span class="o">=</span> <span
                  class="n">host</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The hostname of the target server.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span
                  class="n">port</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    The port of the target server. For regular Gopher servers, this is most commonly 70, </span>
<span class="sd">    and for S/Gopher servers it is typically 105.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tls</span> <span class="o">=</span> <span
                  class="n">tls</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    True if the selector leads to an S/Gopher server with TLS enabled.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre>
      </div>

  </div>
  </div>

  </div>


          <div class="item">
              <div class="name def" id="pituophis.Selector.source">
                  <p>def <span class="ident">source</span>(</p>
                  <p>self)</p>
              </div>


              <div class="desc"><p>Returns a representation of what the selector looks like in a Gopher menu.</p></div>
              <div class="source_cont">
                  <p class="source_link"><a href="javascript:void(0);"
                                            onclick="toggle('source-pituophis.Selector.source', this);">Show source
                      &equiv;</a></p>
                  <div id="source-pituophis.Selector.source" class="source">
                      <div class="codehilite"><pre><span></span><span class="k">def</span> <span
                              class="nf">source</span><span class="p">(</span><span class="bp">self</span><span
                              class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a representation of what the selector looks like in a Gopher menu.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span
                                  class="bp">self</span><span class="o">.</span><span class="n">port</span><span
                                  class="p">)</span>
    <span class="k">if</span> <span class="n">port</span> <span class="o">&lt;</span> <span class="mi">65535</span><span
                                  class="p">:</span>
        <span class="c1"># Add digits to display that this is a TLS selector</span>
        <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span
                                  class="p">(</span><span class="n">port</span><span class="p">))</span> <span
                                  class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
            <span class="n">port</span> <span class="o">=</span> <span class="s1">&#39;0&#39;</span> <span
                                  class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">port</span><span
                                  class="p">)</span>
        <span class="n">port</span> <span class="o">=</span> <span class="s1">&#39;1&#39;</span> <span
                                  class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">port</span><span
                                  class="p">)</span>
        <span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span
                                  class="n">port</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span
                                  class="o">.</span><span class="n">type</span><span class="p">)</span> <span class="o">+</span> <span
                                  class="nb">str</span><span class="p">(</span><span class="bp">self</span><span
                                  class="o">.</span><span class="n">text</span><span class="p">)</span> <span class="o">+</span> <span
                                  class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span
                                  class="o">+</span> <span class="nb">str</span><span class="p">(</span><span
                                  class="bp">self</span><span class="o">.</span><span class="n">path</span><span
                                  class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span
                                  class="se">\t</span><span class="s1">&#39;</span> <span class="o">+</span> <span
                                  class="nb">str</span><span class="p">(</span><span class="bp">self</span><span
                                  class="o">.</span><span class="n">host</span><span class="p">)</span> <span class="o">+</span> <span
                                  class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span> <span
                                  class="o">+</span> <span class="nb">str</span><span class="p">(</span>
        <span class="n">port</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;</span><span
                                  class="se">\r\n</span><span class="s1">&#39;</span>
</pre></div>

  </div>
</div>

  </div>

          <h3>Instance variables</h3>
          <div class="item">
              <p id="pituophis.Selector.host" class="name">var <span class="ident">host</span></p>


              <div class="desc"><p>The hostname of the target server.</p></div>
              <div class="source_cont">
              </div>

          </div>
          <div class="item">
              <p id="pituophis.Selector.path" class="name">var <span class="ident">path</span></p>


              <div class="desc"><p>Where the item links to on the target server.</p></div>
              <div class="source_cont">
              </div>

          </div>
          <div class="item">
              <p id="pituophis.Selector.port" class="name">var <span class="ident">port</span></p>


              <div class="desc"><p>The port of the target server. For regular Gopher servers, this is most commonly 70,
                  and for S/Gopher servers it is typically 105.</p></div>
              <div class="source_cont">
              </div>

          </div>
          <div class="item">
              <p id="pituophis.Selector.text" class="name">var <span class="ident">text</span></p>


              <div class="desc"><p>The name, or text that is displayed when the item is in a menu.</p></div>
              <div class="source_cont">
              </div>

          </div>
          <div class="item">
              <p id="pituophis.Selector.tls" class="name">var <span class="ident">tls</span></p>


              <div class="desc"><p>True if the selector leads to an S/Gopher server with TLS enabled.</p></div>
              <div class="source_cont">
              </div>

          </div>
          <div class="item">
              <p id="pituophis.Selector.type" class="name">var <span class="ident">type</span></p>


              <div class="desc"><p>The type of item.</p></div>
              <div class="source_cont">
              </div>

          </div>
      </div>
      </div>

  </section>

    </article>
  <div class="clear"> </div>
  <footer id="footer">
    <p>
      Documentation generated by
      <a href="https://github.com/BurntSushi/pdoc">pdoc 0.3.2</a>
    </p>

    <p>pdoc is in the public domain with the
      <a href="http://unlicense.org">UNLICENSE</a></p>

    <p>Design by <a href="http://nadh.in">Kailash Nadh</a></p>
  </footer>
</div>
</body>
</html>
